// Code generated by gen, DO NOT EDIT.

package id

import (
	"encoding/json"
	"testing"

	"github.com/oklog/ulid"
	"github.com/stretchr/testify/assert"
)

func TestNewDatasetSchemaFieldID(t *testing.T) {
	id := NewDatasetSchemaFieldID()
	assert.NotNil(t, id)
	u, err := ulid.Parse(id.String())
	assert.NotNil(t, u)
	assert.Nil(t, err)
}

func TestDatasetSchemaFieldIDFrom(t *testing.T) {
	tests := []struct {
		name     string
		input    string
		expected struct {
			result DatasetSchemaFieldID
			err    error
		}
	}{
		{
			name:  "Fail:Not valid string",
			input: "testMustFail",
			expected: struct {
				result DatasetSchemaFieldID
				err    error
			}{
				result: DatasetSchemaFieldID{},
				err:    ErrInvalidID,
			},
		},
		{
			name:  "Fail:Not valid string",
			input: "",
			expected: struct {
				result DatasetSchemaFieldID
				err    error
			}{
				result: DatasetSchemaFieldID{},
				err:    ErrInvalidID,
			},
		},
		{
			name:  "success:valid string",
			input: "01f2r7kg1fvvffp0gmexgy5hxy",
			expected: struct {
				result DatasetSchemaFieldID
				err    error
			}{
				result: DatasetSchemaFieldID{ulid.MustParse("01f2r7kg1fvvffp0gmexgy5hxy")},
				err:    nil,
			},
		},
	}
	for _, tt := range tests {
		tt := tt
		t.Run(tt.name, func(t *testing.T) {
			t.Parallel()
			result, err := DatasetSchemaFieldIDFrom(tt.input)
			assert.Equal(t, tt.expected.result, result)
			if tt.expected.err != nil {
				assert.Equal(t, tt.expected.err, err)
			}
		})
	}
}

func TestMustDatasetSchemaFieldID(t *testing.T) {
	tests := []struct {
		name        string
		input       string
		shouldPanic bool
		expected    DatasetSchemaFieldID
	}{
		{
			name:        "Fail:Not valid string",
			input:       "testMustFail",
			shouldPanic: true,
		},
		{
			name:        "Fail:Not valid string",
			input:       "",
			shouldPanic: true,
		},
		{
			name:        "success:valid string",
			input:       "01f2r7kg1fvvffp0gmexgy5hxy",
			shouldPanic: false,
			expected:    DatasetSchemaFieldID{ulid.MustParse("01f2r7kg1fvvffp0gmexgy5hxy")},
		},
	}

	for _, tt := range tests {
		tt := tt
		t.Run(tt.name, func(t *testing.T) {
			t.Parallel()
			if tt.shouldPanic {
				assert.Panics(t, func() { MustBeID(tt.input) })
				return
			}
			result := MustDatasetSchemaFieldID(tt.input)
			assert.Equal(t, tt.expected, result)
		})
	}
}

func TestDatasetSchemaFieldIDFromRef(t *testing.T) {
	tests := []struct {
		name     string
		input    string
		expected *DatasetSchemaFieldID
	}{
		{
			name:     "Fail:Not valid string",
			input:    "testMustFail",
			expected: nil,
		},
		{
			name:     "Fail:Not valid string",
			input:    "",
			expected: nil,
		},
		{
			name:     "success:valid string",
			input:    "01f2r7kg1fvvffp0gmexgy5hxy",
			expected: &DatasetSchemaFieldID{ulid.MustParse("01f2r7kg1fvvffp0gmexgy5hxy")},
		},
	}

	for _, tt := range tests {
		tt := tt
		t.Run(tt.name, func(t *testing.T) {
			t.Parallel()
			result := DatasetSchemaFieldIDFromRef(&tt.input)
			assert.Equal(t, tt.expected, result)
		})
	}
}

func TestDatasetSchemaFieldIDFromRefID(t *testing.T) {
	id := New()
	id2 := DatasetSchemaFieldIDFromRefID(&id)
	assert.Equal(t, id.id, id2.id)
	assert.Nil(t, DatasetSchemaFieldIDFromRefID(nil))
	assert.Nil(t, DatasetSchemaFieldIDFromRefID(&ID{}))
}

func TestDatasetSchemaFieldID_ID(t *testing.T) {
	id := New()
	id2 := DatasetSchemaFieldIDFromRefID(&id)
	assert.Equal(t, id, id2.ID())
}

func TestDatasetSchemaFieldID_String(t *testing.T) {
	id := New()
	id2 := DatasetSchemaFieldIDFromRefID(&id)
	assert.Equal(t, id.String(), id2.String())
	assert.Equal(t, "", DatasetSchemaFieldID{}.String())
}

func TestDatasetSchemaFieldID_RefString(t *testing.T) {
	id := NewDatasetSchemaFieldID()
	assert.Equal(t, id.String(), *id.RefString())
	assert.Nil(t, DatasetSchemaFieldID{}.RefString())
}

func TestDatasetSchemaFieldID_GoString(t *testing.T) {
	id := New()
	id2 := DatasetSchemaFieldIDFromRefID(&id)
	assert.Equal(t, "DatasetSchemaFieldID("+id.String()+")", id2.GoString())
	assert.Equal(t, "DatasetSchemaFieldID()", DatasetSchemaFieldID{}.GoString())
}

func TestDatasetSchemaFieldID_Ref(t *testing.T) {
	id := NewDatasetSchemaFieldID()
	assert.Equal(t, DatasetSchemaFieldID(id), *id.Ref())
	assert.Nil(t, (&DatasetSchemaFieldID{}).Ref())
}

func TestDatasetSchemaFieldID_Contains(t *testing.T) {
	id := NewDatasetSchemaFieldID()
	id2 := NewDatasetSchemaFieldID()
	assert.True(t, id.Contains([]DatasetSchemaFieldID{id, id2}))
	assert.False(t, DatasetSchemaFieldID{}.Contains([]DatasetSchemaFieldID{id, id2, {}}))
	assert.False(t, id.Contains([]DatasetSchemaFieldID{id2}))
}

func TestDatasetSchemaFieldID_CopyRef(t *testing.T) {
	id := NewDatasetSchemaFieldID().Ref()
	id2 := id.CopyRef()
	assert.Equal(t, id, id2)
	assert.NotSame(t, id, id2)
	assert.Nil(t, (*DatasetSchemaFieldID)(nil).CopyRef())
}

func TestDatasetSchemaFieldID_IDRef(t *testing.T) {
	id := New()
	id2 := DatasetSchemaFieldIDFromRefID(&id)
	assert.Equal(t, &id, id2.IDRef())
	assert.Nil(t, (&DatasetSchemaFieldID{}).IDRef())
	assert.Nil(t, (*DatasetSchemaFieldID)(nil).IDRef())
}

func TestDatasetSchemaFieldID_StringRef(t *testing.T) {
	id := NewDatasetSchemaFieldID()
	assert.Equal(t, id.String(), *id.StringRef())
	assert.Nil(t, (&DatasetSchemaFieldID{}).StringRef())
	assert.Nil(t, (*DatasetSchemaFieldID)(nil).StringRef())
}

func TestDatasetSchemaFieldID_MarhsalJSON(t *testing.T) {
	id := NewDatasetSchemaFieldID()
	res, err := id.MarhsalJSON()
	assert.Nil(t, err)
	exp, _ := json.Marshal(id.String())
	assert.Equal(t, exp, res)

	res, err = (&DatasetSchemaFieldID{}).MarhsalJSON()
	assert.Nil(t, err)
	assert.Nil(t, res)

	res, err = (*DatasetSchemaFieldID)(nil).MarhsalJSON()
	assert.Nil(t, err)
	assert.Nil(t, res)
}

func TestDatasetSchemaFieldID_UnmarhsalJSON(t *testing.T) {
	jsonString := "\"01f3zhkysvcxsnzepyyqtq21fb\""
	id := MustDatasetSchemaFieldID("01f3zhkysvcxsnzepyyqtq21fb")
	id2 := &DatasetSchemaFieldID{}
	err := id2.UnmarhsalJSON([]byte(jsonString))
	assert.Nil(t, err)
	assert.Equal(t, id, *id2)
}

func TestDatasetSchemaFieldID_MarshalText(t *testing.T) {
	id := New()
	res, err := DatasetSchemaFieldIDFromRefID(&id).MarshalText()
	assert.Nil(t, err)
	assert.Equal(t, []byte(id.String()), res)

	res, err = (&DatasetSchemaFieldID{}).MarshalText()
	assert.Nil(t, err)
	assert.Nil(t, res)

	res, err = (*DatasetSchemaFieldID)(nil).MarshalText()
	assert.Nil(t, err)
	assert.Nil(t, res)
}

func TestDatasetSchemaFieldID_UnmarshalText(t *testing.T) {
	text := []byte("01f3zhcaq35403zdjnd6dcm0t2")
	id2 := &DatasetSchemaFieldID{}
	err := id2.UnmarshalText(text)
	assert.Nil(t, err)
	assert.Equal(t, "01f3zhcaq35403zdjnd6dcm0t2", id2.String())
}

func TestDatasetSchemaFieldID_IsNil(t *testing.T) {
	assert.True(t, DatasetSchemaFieldID{}.IsNil())
	assert.False(t, NewDatasetSchemaFieldID().IsNil())
}

func TestDatasetSchemaFieldID_IsNilRef(t *testing.T) {
	assert.True(t, DatasetSchemaFieldID{}.Ref().IsNilRef())
	assert.True(t, (*DatasetSchemaFieldID)(nil).IsNilRef())
	assert.False(t, NewDatasetSchemaFieldID().Ref().IsNilRef())
}

func TestDatasetSchemaFieldIDsToStrings(t *testing.T) {
	tests := []struct {
		name     string
		input    []DatasetSchemaFieldID
		expected []string
	}{
		{
			name:     "Empty slice",
			input:    make([]DatasetSchemaFieldID, 0),
			expected: make([]string, 0),
		},
		{
			name:     "1 element",
			input:    []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2")},
			expected: []string{"01f3zhcaq35403zdjnd6dcm0t2"},
		},
		{
			name: "multiple elements",
			input: []DatasetSchemaFieldID{
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
			},
			expected: []string{
				"01f3zhcaq35403zdjnd6dcm0t1",
				"01f3zhcaq35403zdjnd6dcm0t2",
				"01f3zhcaq35403zdjnd6dcm0t3",
			},
		},
	}

	for _, tt := range tests {
		tt := tt
		t.Run(tt.name, func(t *testing.T) {
			t.Parallel()
			assert.Equal(t, tt.expected, DatasetSchemaFieldIDsToStrings(tt.input))
		})
	}
}

func TestDatasetSchemaFieldIDsFrom(t *testing.T) {
	tests := []struct {
		name     string
		input    []string
		expected struct {
			res []DatasetSchemaFieldID
			err error
		}
	}{
		{
			name:  "Empty slice",
			input: make([]string, 0),
			expected: struct {
				res []DatasetSchemaFieldID
				err error
			}{
				res: make([]DatasetSchemaFieldID, 0),
				err: nil,
			},
		},
		{
			name:  "1 element",
			input: []string{"01f3zhcaq35403zdjnd6dcm0t2"},
			expected: struct {
				res []DatasetSchemaFieldID
				err error
			}{
				res: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2")},
				err: nil,
			},
		},
		{
			name: "multiple elements",
			input: []string{
				"01f3zhcaq35403zdjnd6dcm0t1",
				"01f3zhcaq35403zdjnd6dcm0t2",
				"01f3zhcaq35403zdjnd6dcm0t3",
			},
			expected: struct {
				res []DatasetSchemaFieldID
				err error
			}{
				res: []DatasetSchemaFieldID{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
				},
				err: nil,
			},
		},
		{
			name: "error",
			input: []string{
				"01f3zhcaq35403zdjnd6dcm0t1",
				"x",
				"01f3zhcaq35403zdjnd6dcm0t3",
			},
			expected: struct {
				res []DatasetSchemaFieldID
				err error
			}{
				res: nil,
				err: ErrInvalidID,
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			res, err := DatasetSchemaFieldIDsFrom(tc.input)
			if tc.expected.err != nil {
				assert.Equal(t, tc.expected.err, err)
				assert.Nil(t, res)
			} else {
				assert.Nil(t, err)
				assert.Equal(t, tc.expected.res, res)
			}
		})
	}
}

func TestDatasetSchemaFieldIDsFromID(t *testing.T) {
	t.Parallel()
	tests := []struct {
		name     string
		input    []ID
		expected []DatasetSchemaFieldID
	}{
		{
			name:     "Empty slice",
			input:    make([]ID, 0),
			expected: make([]DatasetSchemaFieldID, 0),
		},
		{
			name:     "1 element",
			input:    []ID{MustBeID("01f3zhcaq35403zdjnd6dcm0t2")},
			expected: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2")},
		},
		{
			name: "multiple elements",
			input: []ID{
				MustBeID("01f3zhcaq35403zdjnd6dcm0t1"),
				MustBeID("01f3zhcaq35403zdjnd6dcm0t2"),
				MustBeID("01f3zhcaq35403zdjnd6dcm0t3"),
			},
			expected: []DatasetSchemaFieldID{
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			res := DatasetSchemaFieldIDsFromID(tc.input)
			assert.Equal(t, tc.expected, res)
		})
	}
}

func TestDatasetSchemaFieldIDsFromIDRef(t *testing.T) {
	id1 := MustBeID("01f3zhcaq35403zdjnd6dcm0t1")
	id2 := MustBeID("01f3zhcaq35403zdjnd6dcm0t2")
	id3 := MustBeID("01f3zhcaq35403zdjnd6dcm0t3")

	tests := []struct {
		name     string
		input    []*ID
		expected []DatasetSchemaFieldID
	}{
		{
			name:     "Empty slice",
			input:    make([]*ID, 0),
			expected: make([]DatasetSchemaFieldID, 0),
		},
		{
			name:     "1 element",
			input:    []*ID{&id1},
			expected: []DatasetSchemaFieldID{MustDatasetSchemaFieldID(id1.String())},
		},
		{
			name:  "multiple elements",
			input: []*ID{&id1, &id2, &id3},
			expected: []DatasetSchemaFieldID{
				MustDatasetSchemaFieldID(id1.String()),
				MustDatasetSchemaFieldID(id2.String()),
				MustDatasetSchemaFieldID(id3.String()),
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			res := DatasetSchemaFieldIDsFromIDRef(tc.input)
			assert.Equal(t, tc.expected, res)
		})
	}
}

func TestDatasetSchemaFieldIDsToID(t *testing.T) {
	tests := []struct {
		name     string
		input    []DatasetSchemaFieldID
		expected []ID
	}{
		{
			name:     "Empty slice",
			input:    make([]DatasetSchemaFieldID, 0),
			expected: make([]ID, 0),
		},
		{
			name:     "1 element",
			input:    []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2")},
			expected: []ID{MustBeID("01f3zhcaq35403zdjnd6dcm0t2")},
		},
		{
			name: "multiple elements",
			input: []DatasetSchemaFieldID{
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
			},
			expected: []ID{
				MustBeID("01f3zhcaq35403zdjnd6dcm0t1"),
				MustBeID("01f3zhcaq35403zdjnd6dcm0t2"),
				MustBeID("01f3zhcaq35403zdjnd6dcm0t3"),
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			res := DatasetSchemaFieldIDsToID(tc.input)
			assert.Equal(t, tc.expected, res)
		})
	}
}

func TestDatasetSchemaFieldIDsToIDRef(t *testing.T) {
	id1 := MustBeID("01f3zhcaq35403zdjnd6dcm0t1")
	id21 := MustDatasetSchemaFieldID(id1.String())
	id2 := MustBeID("01f3zhcaq35403zdjnd6dcm0t2")
	id22 := MustDatasetSchemaFieldID(id2.String())
	id3 := MustBeID("01f3zhcaq35403zdjnd6dcm0t3")
	id23 := MustDatasetSchemaFieldID(id3.String())

	tests := []struct {
		name     string
		input    []*DatasetSchemaFieldID
		expected []*ID
	}{
		{
			name:     "Empty slice",
			input:    make([]*DatasetSchemaFieldID, 0),
			expected: make([]*ID, 0),
		},
		{
			name:     "1 element",
			input:    []*DatasetSchemaFieldID{&id21},
			expected: []*ID{&id1},
		},
		{
			name:     "multiple elements",
			input:    []*DatasetSchemaFieldID{&id21, &id22, &id23},
			expected: []*ID{&id1, &id2, &id3},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			res := DatasetSchemaFieldIDsToIDRef(tc.input)
			assert.Equal(t, tc.expected, res)
		})
	}
}

func TestNewDatasetSchemaFieldIDSet(t *testing.T) {
	set := NewDatasetSchemaFieldIDSet()
	assert.NotNil(t, set)
	assert.Empty(t, set.m)
	assert.Empty(t, set.s)
	a := NewDatasetSchemaFieldID()
	b := NewDatasetSchemaFieldID()
	set = NewDatasetSchemaFieldIDSet(a, a, b)
	assert.Equal(t, []DatasetSchemaFieldID{a, b}, set.s)
}

func TestDatasetSchemaFieldIDSet_Add(t *testing.T) {
	tests := []struct {
		name     string
		input    []DatasetSchemaFieldID
		expected *DatasetSchemaFieldIDSet
	}{
		{
			name:  "Empty slice",
			input: make([]DatasetSchemaFieldID, 0),
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{},
				s: nil,
			},
		},
		{
			name:  "1 element",
			input: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
		},
		{
			name: "multiple elements",
			input: []DatasetSchemaFieldID{
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
			},
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"): {},
				},
				s: []DatasetSchemaFieldID{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
				},
			},
		},
		{
			name: "multiple elements with duplication",
			input: []DatasetSchemaFieldID{
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
			},
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"): {},
				},
				s: []DatasetSchemaFieldID{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
				},
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			set := NewDatasetSchemaFieldIDSet()
			set.Add(tc.input...)
			assert.Equal(t, tc.expected, set)
		})
	}
}

func TestDatasetSchemaFieldIDSet_AddRef(t *testing.T) {
	tests := []struct {
		name     string
		input    *DatasetSchemaFieldID
		expected *DatasetSchemaFieldIDSet
	}{
		{
			name:  "Empty slice",
			input: nil,
			expected: &DatasetSchemaFieldIDSet{
				m: nil,
				s: nil,
			},
		},
		{
			name:  "1 element",
			input: MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1").Ref(),
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			set := NewDatasetSchemaFieldIDSet()
			set.AddRef(tc.input)
			assert.Equal(t, tc.expected, set)
		})
	}
}

func TestDatasetSchemaFieldIDSet_Has(t *testing.T) {
	tests := []struct {
		name     string
		target   *DatasetSchemaFieldIDSet
		input    DatasetSchemaFieldID
		expected bool
	}{
		{
			name:     "Empty Set",
			target:   &DatasetSchemaFieldIDSet{},
			input:    MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
			expected: false,
		},
		{
			name: "Set Contains the element",
			target: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
			input:    MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
			expected: true,
		},
		{
			name: "Set does not Contains the element",
			target: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
			input:    MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
			expected: false,
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			assert.Equal(t, tc.expected, tc.target.Has(tc.input))
		})
	}
}

func TestDatasetSchemaFieldIDSet_Clear(t *testing.T) {
	tests := []struct {
		name     string
		input    *DatasetSchemaFieldIDSet
		expected *DatasetSchemaFieldIDSet
	}{
		{
			name:     "Empty set",
			input:    &DatasetSchemaFieldIDSet{},
			expected: &DatasetSchemaFieldIDSet{},
		},
		{
			name:     "Nil set",
			input:    nil,
			expected: nil,
		},
		{
			name: "Contains the element",
			input: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
			expected: &DatasetSchemaFieldIDSet{
				m: nil,
				s: nil,
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			tc.input.Clear()
			assert.Equal(t, tc.expected, tc.input)
		})
	}
}

func TestDatasetSchemaFieldIDSet_All(t *testing.T) {
	tests := []struct {
		name     string
		input    *DatasetSchemaFieldIDSet
		expected []DatasetSchemaFieldID
	}{
		{
			name: "Empty",
			input: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{},
				s: nil,
			},
			expected: make([]DatasetSchemaFieldID, 0),
		},
		{
			name:     "Nil",
			input:    nil,
			expected: nil,
		},
		{
			name: "1 element",
			input: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
			expected: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
		},
		{
			name: "multiple elements",
			input: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"): {},
				},
				s: []DatasetSchemaFieldID{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
				},
			},
			expected: []DatasetSchemaFieldID{
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
				MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			assert.Equal(t, tc.expected, tc.input.All())
		})
	}
}

func TestDatasetSchemaFieldIDSet_Clone(t *testing.T) {
	tests := []struct {
		name     string
		input    *DatasetSchemaFieldIDSet
		expected *DatasetSchemaFieldIDSet
	}{
		{
			name:     "nil set",
			input:    nil,
			expected: NewDatasetSchemaFieldIDSet(),
		},
		{
			name:     "Empty set",
			input:    NewDatasetSchemaFieldIDSet(),
			expected: NewDatasetSchemaFieldIDSet(),
		},
		{
			name: "1 element",
			input: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
		},
		{
			name: "multiple elements",
			input: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"): {},
				},
				s: []DatasetSchemaFieldID{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
				},
			},
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"): {},
				},
				s: []DatasetSchemaFieldID{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t3"),
				},
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			clone := tc.input.Clone()
			assert.Equal(t, tc.expected, clone)
			assert.NotSame(t, tc.input, clone)
		})
	}
}

func TestDatasetSchemaFieldIDSet_Merge(t *testing.T) {
	tests := []struct {
		name  string
		input struct {
			a *DatasetSchemaFieldIDSet
			b *DatasetSchemaFieldIDSet
		}
		expected *DatasetSchemaFieldIDSet
	}{
		{
			name: "Nil Set",
			input: struct {
				a *DatasetSchemaFieldIDSet
				b *DatasetSchemaFieldIDSet
			}{
				a: &DatasetSchemaFieldIDSet{
					m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
					s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
				},
				b: nil,
			},
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
		},
		{
			name: "Empty Set",
			input: struct {
				a *DatasetSchemaFieldIDSet
				b *DatasetSchemaFieldIDSet
			}{
				a: &DatasetSchemaFieldIDSet{},
				b: &DatasetSchemaFieldIDSet{},
			},
			expected: &DatasetSchemaFieldIDSet{},
		},
		{
			name: "1 Empty Set",
			input: struct {
				a *DatasetSchemaFieldIDSet
				b *DatasetSchemaFieldIDSet
			}{
				a: &DatasetSchemaFieldIDSet{
					m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
					s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
				},
				b: &DatasetSchemaFieldIDSet{},
			},
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
				s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
			},
		},
		{
			name: "2 non Empty Set",
			input: struct {
				a *DatasetSchemaFieldIDSet
				b *DatasetSchemaFieldIDSet
			}{
				a: &DatasetSchemaFieldIDSet{
					m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {}},
					s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1")},
				},
				b: &DatasetSchemaFieldIDSet{
					m: map[DatasetSchemaFieldID]struct{}{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"): {}},
					s: []DatasetSchemaFieldID{MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2")},
				},
			},
			expected: &DatasetSchemaFieldIDSet{
				m: map[DatasetSchemaFieldID]struct{}{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"): {},
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"): {},
				},
				s: []DatasetSchemaFieldID{
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t1"),
					MustDatasetSchemaFieldID("01f3zhcaq35403zdjnd6dcm0t2"),
				},
			},
		},
	}

	for _, tc := range tests {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()
			assert.Equal(t, tc.expected, tc.input.a.Merge(tc.input.b))
		})
	}
}
